metadata:
  suite_name: ABB SHOP DATA PRESENCE
  index_column: MATERIAL_NUMBER
  description: ''
  data_source: get_level_1_dataframe
data_source:
  table: PROD_MO_MONM.REPORTING."vw_ProductDataAll"
  filters:
    PRODUCT_HIERARCHY: LIKE '5%'
    OMS_FLAG: Y
    CATALOG_501: X
    SERIAL_NUMBER_PROFILE: <> ZUS4
    PLANT: 00A
  distinct: true
validations:
- type: expect_column_values_to_not_be_null
  columns:
  - ABP_ELECTRICALDATA1
  - ABP_EFFICIENCYLEVEL
  - ABP_INSULATIONCLASS
  - ABP_NUMBEROFPHASES
  - ABP_NUMBEROFPOLES
  - ABP_SERVICEFACTOR
  - ABP_ENCLOSURETYPE
  - ABP_MOTORBASETYPE
  - ABP_MOUNTINGORIENTATION
  - ABP_BRAKEPRESENT
  - ABP_CERTIFICATIONAGENCY
  - Z01_MKT_NAMEPLATE_SPEED
  - Z01_MKT_NAMEPLATE_AMPS
  - Z01_MKT_NAMEPLATE_OUTPUT
  - Z01_MKT_NAMEPLATE_VOLTAGE
  - Z01_MKT_NAMEPLATE_FREQUENCY
  - Z01_MKT_EFFICIENCY_LEVEL
  - Z01_MKT_INSULATION_CLASS
  - Z01_MKT_DESIGN_CODE
  - Z01_MKT_PHASE
  - Z01_MKT_NUMBER_POLES
  - Z01_MKT_SERVICE_FACTOR
  - Z01_MKT_DUTY
  - Z01_MKT_ENCLOSURE
  - Z01_MKT_FRAME
  - Z01_MKT_BASE_INDICATOR
  - Z01_MKT_MOUNTING_ORIENT
  - Z01_MKT_BRAKE_INDICATOR
  - Z01_MKT_AGENCY_LOGOS
  - ENG_RPM
  - ENG_OUTPUT
  - ENG_FREQUENCY
  - ENG_VOLTAGE
  - ENG_AMPS
  - ENG_EFFICIENCY_LEVEL
  - ENG_INSULATION_CLASS
  - ENG_NEMA_DESIGN_CODE
  - ENG_PHASE
  - ENG_POLES
  - ENG_SERVICE_FACTOR
  - ENG_DUTY_TYPE
  - ENG_ENCLOSURE
  - ENG_FRAME_SIZE
  - ENG_MOUNTING_TYPE
  - ENG_MOUNTING_ORIENTATION
  - ENG_BRAKE_CODE
  - ENG_AGENCY_LOGOS_READABLE
  - ABP_TYPEOFDUTY
- type: expect_column_values_to_not_be_null
  columns:
  - Z01_MKT_DESIGN_CODE
  conditional_on:
    derived_status: Z01_MKT_DESIGN_CODE
    membership: include
- type: expect_column_values_to_not_be_null
  columns:
  - ABP_FRAMESIZE
  conditional_on:
    derived_status: NON_FRAME_MATERIALS
    membership: include
derived_statuses:
- status: ABP DATA INCOMPLETE
  columns:
  - ABP_BRAKEPRESENT
  - ABP_CERTIFICATIONAGENCY
  - ABP_EFFICIENCYLEVEL
  - ABP_ELECTRICALDATA1
  - ABP_ENCLOSURETYPE
  - ABP_INSULATIONCLASS
  - ABP_MOTORBASETYPE
  - ABP_MOUNTINGORIENTATION
  - ABP_NUMBEROFPHASES
  - ABP_NUMBEROFPOLES
  - ABP_SERVICEFACTOR
  - ABP_TYPEOFDUTY
  - ABP_FRAMESIZE
  - ABP_NEMADESIGNCODE
  expectation_type: expect_column_values_to_not_be_null
- status: Z01 DATA INCOMPLETE
  columns:
  - Z01_MKT_AGENCY_LOGOS
  - Z01_MKT_BASE_INDICATOR
  - Z01_MKT_BRAKE_INDICATOR
  - Z01_MKT_DESIGN_CODE
  - Z01_MKT_DUTY
  - Z01_MKT_EFFICIENCY_LEVEL
  - Z01_MKT_ENCLOSURE
  - Z01_MKT_FRAME
  - Z01_MKT_INSULATION_CLASS
  - Z01_MKT_MOUNTING_ORIENT
  - Z01_MKT_NAMEPLATE_AMPS
  - Z01_MKT_NAMEPLATE_FREQUENCY
  - Z01_MKT_NAMEPLATE_OUTPUT
  - Z01_MKT_NAMEPLATE_SPEED
  - Z01_MKT_NAMEPLATE_VOLTAGE
  - Z01_MKT_NUMBER_POLES
  - Z01_MKT_PHASE
  - Z01_MKT_SERVICE_FACTOR
  expectation_type: expect_column_values_to_not_be_null
- status: ENG DATA INCOMPLETE
  columns:
  - ENG_AMPS
  - ENG_AGENCY_LOGOS_READABLE
  - ENG_BRAKE_CODE
  - ENG_DUTY_TYPE
  - ENG_EFFICIENCY_LEVEL
  - ENG_ENCLOSURE
  - ENG_FRAME_SIZE
  - ENG_FREQUENCY
  - ENG_INSULATION_CLASS
  - ENG_MOUNTING_ORIENTATION
  - ENG_MOUNTING_TYPE
  - ENG_NEMA_DESIGN_CODE
  - ENG_OUTPUT
  - ENG_PHASE
  - ENG_POLES
  - ENG_RPM
  - ENG_SERVICE_FACTOR
  - ENG_VOLTAGE
  expectation_type: expect_column_values_to_not_be_null
- status: Z01_MKT_DESIGN_CODE
  columns:
  - Z01_MKT_DESIGN_CODE
  expectation_type: expect_column_values_to_be_in_set
  rules:
    Z01_MKT_DESIGN_CODE:
    - '-'
- status: NON_FRAME_MATERIALS
  columns:
  - PRODUCT_HIERARCHY
  expectation_type: expect_column_values_to_be_in_set
  rules:
    PRODUCT_HIERARCHY:
    - '508009032029901650'
    - '508009032029901600'
    - '508009032029901625'
    - '508009032029901675'
derived_lists:
- name: READY FOR ABP DATA LOAD
  exclude_statuses:
  - Z01 DATA INCOMPLETE
  - ENG DATA INCOMPLETE
